---
title: "The Impact of Seasonal Changes on Mortality Rates in Toronto"
subtitle: "Death Registry Statistics in Toronto"
author: 
  - Doran Wang
thanks: "Code and data are available at: https://github.com/Wang20030509/Sta304-Term-Paper-1"
date: today
date-format: long
abstract: "This study analyzes death toll data across four civic centers (ET, NY, SC, and TO) from 2011 to 2023, with the goal of identifying seasonal patterns and regional differences in mortality. Utilizing death registry data, we categorized the deaths by season—Winter, Spring, Summer, and Fall—and aggregated the death tolls across the years for each region. The analysis revealed notable variations in mortality trends across both seasons and civic centers. The results show that Winter consistently reported higher death tolls compared to other seasons across most regions, with the NY and ET civic centers experiencing the highest tolls during this period. In contrast, SC and TO exhibited more balanced seasonal distributions, with Summer showing a slightly elevated death toll. Using visual representations generated through ggplot2, the findings highlight significant regional disparities, which suggest possible influences of environmental, socio-economic, or health system factors contributing to seasonal mortality trends."
format: pdf
toc: true
toc-title: "Table of Contents"
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(dplyr)
library(readr)
library(janitor)
library(opendatatoronto)
library(knitr)
library(here)

raw_data <- read_csv("../data/raw_data/death_registry.csv",
                    show_col_types = FALSE)
data <- read_csv("../data/analysis_data/cleaned_data.csv",
                 show_col_types = FALSE)
total_deaths <- read_csv("../data/analysis_data/summarize_data.csv",
                         show_col_types = FALSE)
avg_death <- read_csv("../data/analysis_data/avg_deaths_by_month.csv",
                      show_col_types = FALSE)
```

# Introduction

You can and should cross-reference sections and sub-sections. We use @citeR, @rohan and @rOpenDataToronto.

The remainder of this paper is structured as follows. @sec-data....



# Data {#sec-data}

Some of our data is of deaths (@fig-deaths), from @deathRegistryData.

## Overview Data
```{r}
#| echo: false
#| eval: true
#| label: tbl-death_registry_data
#| tbl-cap: "Sample Data"
#| warning: false
kable(head(raw_data))

```

## Cleaned Data
```{r}
#| echo: false
#| eval: true
#| label: tbl-cleaned_death_registry_data
#| tbl-cap: "Sample Data"
#| warning: false

data |>
  head(5) |>
  kable(col.names = c("ID", "Civic Centre", "Death Toll", "Place of Death", "Year", "Month", "Season"),
    booktabs = TRUE
  )

```

The

```{r warning=FALSE}
#| label: fig-deaths
#| fig-cap: Total Death Toll by Season and Region (2011-2023)
#| echo: false

ggplot(total_deaths, aes(x = season, y = death_licenses, fill = season)) +
  geom_bar(stat = "identity", alpha = 1) +  
  scale_fill_manual(values = c("darkorange", "purple", "cyan4", "red")) +  
  theme_minimal() +
  facet_wrap(~civic_centre, ncol = 2, scales = "free_y") +  
  labs(x = "Season", y = "Total Death Toll", fill = "Season") +
  coord_flip()

```


```{r warning=FALSE}
#| label: fig-Total_Deaths
#| fig-cap: Total Death toll by Season (2011-2023)
#| echo: false

# Plot the total deaths from 2011 to 2024
ggplot(total_deaths, aes(x = season, y = death_licenses, fill = season)) +
  geom_bar(stat = "identity", alpha = 1) +
  scale_fill_manual(values = c("darkorange", "purple", "cyan4", "red")) + 
  theme_minimal() +
  labs(x = "Session", y = "Total Death Toll", fill = "Season") +
  coord_flip()

```
```{r warning=FALSE}
#| label: fig-avg_deaths_by_month
#| fig-cap: Average Death Toll by Month (2011-2023)
#| echo: false

avg_death$month <- factor(avg_death$month, 
                          levels = c("Jan", "Feb", "Mar", "Apr", "May", "Jun", 
                                     "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"))

# Plot the average deaths by month from 2011 to 2023
ggplot(avg_death, aes(x = factor(month), y = death_licenses, fill = factor(month))) +
  geom_bar(stat = "identity", alpha = 1) +
  theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
  theme_minimal() +
  theme_light() +
  labs(x = "Month", y = "Average Death Toll", fill = "Month") 
```


And also planes (@fig-planes). (You can change the height and width, but don't worry about doing that until you have finished every other aspect of the paper - Quarto will try to make it look nice and the defaults usually work well once you have enough text.)

```{r}
#| label: fig-planes
#| fig-cap: Relationship between wing length and width
#| echo: false
#| warning: false
#| message: false


```




# Results

Our results are summarized in @tbl-modelresults.





# Discussion

## First discussion point {#sec-first-point}

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional data details

# Model details {#sec-model-details}

## Posterior predictive check

In @fig-ppcheckandposteriorvsprior-1 we implement a posterior predictive check. This shows...

In @fig-ppcheckandposteriorvsprior-2 we compare the posterior with the prior. This shows... 


## Diagnostics

@fig-stanareyouokay-1 is a trace plot. It shows... This suggests...

@fig-stanareyouokay-2 is a Rhat plot. It shows... This suggests...





\newpage


# References


